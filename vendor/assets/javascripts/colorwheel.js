(function(h){h.colorwheel=function(c,f,b,h,g){return new u(c,f,b,h,g)};var t=Math.PI,u=function(c,f,b,n,g){var b=b||200,o=3*b/200,r=b/200,k=t*b/5,j=b/20,e=b/2,d=2*b/200,a=this,l=b-4*j,g=g?h(g,b,b):h(c,f,b,b),q=l/6+2*j+d,l=2*l/3-2*d;1>r&&(r=1);1>o&&(o=1);for(var p=t/2-1.3*(2*t/k),i=e-d,m=e-d-2*j,p=["M",e,d,"A",i,i,0,0,1,i*Math.cos(p)+i+d,i-i*Math.sin(p)+d,"L",m*Math.cos(p)+i+d,i-m*Math.sin(p)+d,"A",m,m,0,0,0,e,d+2*j,"z"].join(),s=0;s<k;s++)g.path(p).attr({stroke:"none",fill:"hsb("+s*(255/k)/255+", 1, 0.78)",
transform:"r"+[360/k*s,e,e]});g.path(["M",e,d,"A",i,i,0,1,1,e-1,d,"l1,0","M",e,d+2*j,"A",m,m,0,1,1,e-1,d+2*j,"l1,0"]).attr({"stroke-width":o,stroke:"#fff"});a.cursorhsb=g.set();k=2*j+2;a.cursorhsb.push(g.rect(e-k/1.6180339887/2,d-1,k/1.6180339887,k,3*b/200).attr({stroke:"#000",opacity:0.5,"stroke-width":o}));a.cursorhsb.push(a.cursorhsb[0].clone().attr({stroke:"#fff",opacity:1,"stroke-width":r}));a.ring=g.path(["M",e,d,"A",i,i,0,1,1,e-1,d,"l1,0M",e,d+2*j,"A",m,m,0,1,1,e-1,d+2*j,"l1,0"]).attr({fill:"#000",
opacity:0,stroke:"none"});a.main=g.rect(q,q,l,l).attr({stroke:"none",fill:"#f00",opacity:1});a.main.clone().attr({stroke:"none",fill:"0-#fff-#fff",opacity:0});a.square=g.rect(q-1,q-1,l+2,l+2).attr({r:2,stroke:"#fff","stroke-width":o,fill:"90-#000-#000",opacity:0,cursor:"crosshair"});a.cursor=g.set();a.cursor.push(g.circle(e,e,j/2).attr({stroke:"#000",opacity:0.5,"stroke-width":o}));a.cursor.push(a.cursor[0].clone().attr({stroke:"#fff",opacity:1,"stroke-width":r}));a.H=a.S=a.B=1;a.raphael=g;a.size2=
e;a.wh=l;a.x=c;a.xy=q;a.y=f;a.ring.drag(function(b,c,d,e){a.docOnMove(b,c,d,e)},function(b,c){a.hsbOnTheMove=!0;a.setH(b-a.x-a.size2,c-a.y-a.size2)},function(){a.hsbOnTheMove=!1});a.square.drag(function(b,c,d,e){a.docOnMove(b,c,d,e)},function(b,c){a.clrOnTheMove=!0;a.setSB(b-a.x,c-a.y)},function(){a.clrOnTheMove=!1});a.color(n||"#f00");this.onchanged&&this.onchanged(this.color())},n=u.prototype;n.setH=function(c,f){var b=h.angle(c,f,0,0);h.rad(b);this.cursorhsb.attr({transform:"r"+[b+90,this.size2,
this.size2]});this.H=(b+90)/360;this.main.attr({fill:"hsb("+this.H+",1,1)"});this.onchange&&this.onchange(this.color())};n.setSB=function(c,f){c<this.size2-this.wh/2&&(c=this.size2-this.wh/2);c>this.size2+this.wh/2&&(c=this.size2+this.wh/2);f<this.size2-this.wh/2&&(f=this.size2-this.wh/2);f>this.size2+this.wh/2&&(f=this.size2+this.wh/2);this.cursor.attr({cx:c,cy:f});this.B=1-(f-this.xy)/this.wh;this.S=(c-this.xy)/this.wh;this.onchange&&this.onchange(this.color())};n.docOnMove=function(c,f,b,h){this.hsbOnTheMove&&
this.setH(b-this.x-this.size2,h-this.y-this.size2);this.clrOnTheMove&&this.setSB(b-this.x,h-this.y)};n.remove=function(){this.raphael.remove();this.color=function(){return!1}};n.color=function(c){if(c){var c=h.color(c),f=360*c.h;this.H=c.h;this.S=c.s;this.B=c.v;this.cursorhsb.attr({transform:"r"+[f,this.size2,this.size2]});this.main.attr({fill:"hsb("+this.H+",1,1)"});this.cursor.attr({cx:this.S*this.wh+this.xy,cy:(1-this.B)*this.wh+this.xy});return this}return h.hsb2rgb(this.H,this.S,this.B).hex}})(window.Raphael);
